var E=Object.defineProperty;var y=(s,e,t)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var d=(s,e,t)=>(y(s,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();let h=!1;const g=(s,e)=>Math.floor(Math.random()*(e-s+1))+s,p=(s,e)=>{const t=r.board.find(n=>n.id===e);if(t&&!t.opened&&!t.flagged){if(t.isMined){s.loss(),t.element.dataset.status="mine",t.element.dataset.color="red";return}if(t.open(),t.neighborMineCount>0)return;t.getNeighbors().forEach(n=>{const i=r.board.find(o=>o.id===n);i&&!i.opened&&!i.flagged&&p(s,n)})}},x=(s,e)=>{const t=r.board.find(n=>n.id===e);if(t&&t.opened&&t.neighborMineCount>0){let n=t.getNeighbors(),i=0,o=[],a=!1;n.forEach(m=>{const c=r.board.find(f=>f.id===m);c&&(c.flagged&&o.push(c),i+=c.flagged?1:0)}),i===t.neighborMineCount&&(o.some(m=>{if(m.flagged&&!m.mined)return s.loss(),a=!0,!0}),a||n.forEach(m=>{const c=r.board.find(f=>f.id===m);c&&!c.flagged&&!c.opened&&(h=!1,p(s,c.id))}))}},N=s=>{var i,o;if(r.gameOver)return;s.preventDefault();const e=(o=(i=s.currentTarget)==null?void 0:i.getAttribute)==null?void 0:o.call(i,"id"),t=r.board.find(a=>a.id===e);if(!t||t.opened)return;!t.flagged&&r.minesRemaining>0?(t.setFlag(),r.minesRemaining--):t.flagged&&(t.unsetFlag(),r.minesRemaining++);const n=document.getElementById("mines-remaining");n!==null&&(n.innerText=String(r.minesRemaining))},C=(s,e)=>{if(r.gameOver)return;if(e.currentTarget&&typeof e.currentTarget.getAttribute=="function"){const n=e.currentTarget.getAttribute("id");h?x(s,n):p(s,n)}let t=!0;r.board.some(n=>{if(!n.isMined&&!n.opened)return t=!1,!0}),t&&s.win()},w=()=>{let s,e=document.getElementById("instructions"),t=e==null?void 0:e.style;e===null||t===void 0||(s=window.getComputedStyle(e),s.display==="block"?t.display="":t.display="block")},M=s=>{((s==null?void 0:s.key)==="Control"||(s==null?void 0:s.key)==="Meta")&&(h=!0)},k=s=>{((s==null?void 0:s.key)==="Control"||(s==null?void 0:s.key)==="Meta")&&(h=!1)};class T{constructor(e,t,n,i,o,a,m){d(this,"game");d(this,"row");d(this,"column");d(this,"opened");d(this,"flagged");d(this,"mined");d(this,"neighborMineCount");d(this,"element");this.game=e,this.row=t,this.column=n,this.opened=i,this.flagged=o,this.mined=a,this.neighborMineCount=m;const c=document.getElementById(this.id);if(!c)throw"Invalid element";this.element=c}get id(){return r.cellPrefix+this.row+""+this.column}get isMined(){return this.mined}getNeighbors(){let e=this.row,t=this.column,n=[],i,o;for(n.push(r.cellPrefix+(e-1)+""+(t-1)),n.push(r.cellPrefix+(e-1)+""+t),n.push(r.cellPrefix+(e-1)+""+(t+1)),n.push(r.cellPrefix+e+""+(t-1)),n.push(r.cellPrefix+e+""+(t+1)),n.push(r.cellPrefix+(e+1)+""+(t-1)),n.push(r.cellPrefix+(e+1)+""+t),n.push(r.cellPrefix+(e+1)+""+(t+1)),i=0;i<n.length;i++)o=document.getElementById(n[i]),o==null&&(n.splice(i,1),i--);return n}getNumberColor(){switch(this.neighborMineCount){case 0:return"empty";case 1:return"blue";case 2:return"green";case 3:return"red";case 4:return"orange";default:return"black"}}unhook(){this.element.removeEventListener("click",e=>C(this.game,e))}hook(){this.element.removeAttribute("style"),this.element.addEventListener("click",e=>C(this.game,e)),this.element.addEventListener("contextmenu",e=>N(e))}open(){this.opened=!0,this.neighborMineCount>0?(this.element.innerText=String(this.neighborMineCount),this.element.dataset.status="",this.element.dataset.color=this.getNumberColor()):(this.element.innerHTML="",this.element.dataset.status="empty",this.element.dataset.color="")}setFlag(){this.flagged=!0,this.element.dataset.status="flag",this.element.dataset.color="red"}unsetFlag(){this.flagged=!1,this.element.innerHTML="",this.element.dataset.status="",this.element.dataset.color=""}}const l=class{constructor(){d(this,"timer",0);d(this,"timeout",0)}static get cellPrefix(){return"c"}static get boardSize(){return 10}loss(){l.gameOver=!0;let e=document.getElementById("messageBox");e!==null&&(e.innerText="Game Over!",Object.assign(e.style,{color:"white",backgroundColor:"red"}),l.board.forEach(t=>{t.mined&&!t.flagged?(t.element.dataset.status="mine",t.element.dataset.color="black"):!t.mined&&t.flagged&&(t.element.dataset.status="flagoff",t.element.dataset.color="black")}),clearInterval(this.timeout))}win(){l.gameOver=!0;let e=document.getElementById("messageBox");if(e===null)return;e.innerText="You Win!";let t={color:"white",backgroundColor:"green"};Object.assign(e.style,t),clearInterval(this.timeout)}newGame(){let e=document.getElementById("time"),t=document.getElementById("messageBox"),n=document.getElementById("mines-remaining");e===null||t===null||n===null||(e.innerText="0",t.innerText="Make a move",Object.assign(t.style,{color:"",backgroundColor:""}),l.minesRemaining=l.mines,n.innerText=Number(l.minesRemaining).toString(),l.gameOver=!1,this.setupBoard(),this.timer=0,clearInterval(this.timeout),this.timeout=setInterval(()=>{e!==null&&(this.timer++,this.timer>=999&&(this.timer=999),e.innerText=Number(this.timer).toString())},1e3))}setupBoard(){let e;for(let t=0;t<l.boardSize;t++)for(let n=0;n<l.boardSize;n++)e=new T(this,t,n,!1,!1,!1,0),e.unhook(),e.hook(),l.board.push(e);this.randomlyAssignMines(),this.calculateNeighborMineCounts()}calculateNeighborMineCounts(){let e=0,t,n;for(let i=0;i<l.boardSize;i++)for(let o=0;o<l.boardSize;o++)t=l.cellPrefix+i+""+o,n=l.board.find(a=>a.id===t),n&&!n.isMined&&(e=0,n.getNeighbors().forEach(a=>{const m=l.board.find(c=>c.id===a);m&&(e+=m.isMined?1:0)}),n.neighborMineCount=e)}randomlyAssignMines(){let e=[],t,n,i,o;for(let a=0;a<l.mines;a++){for(t=g(0,l.boardSize),n=g(0,l.boardSize),i=l.cellPrefix+t+""+n;e.includes(i);)t=g(0,l.boardSize),n=g(0,l.boardSize),i=l.cellPrefix+t+""+n;o=l.board.find(m=>m.id===i),o?(e.push(o.id),o.mined=!0):a--}}};let r=l;d(r,"FLAG","&#9873"),d(r,"FLAGOFF","&#9872"),d(r,"MINE","&#9881"),d(r,"gameOver",!1),d(r,"mines",10),d(r,"minesRemaining",l.mines),d(r,"board",[]);const B="_question_a7btq_1",I="_userDisplay_a7btq_11",O="_instructions_a7btq_22",L="_controls_a7btq_33",P="_button_a7btq_37",S="_messageBox_a7btq_60",A="_board_a7btq_70",u={question:B,userDisplay:I,instructions:O,controls:L,button:P,messageBox:S,board:A};class b{constructor(e){d(this,"parentElement");d(this,"game");this.parentElement=document.getElementsByTagName("main")[0],this.game=e}build(){this.title(),this.instructions(),this.messageBox(),this.board(),this.controls()}static buildInterface(e){new b(e).build()}title(){let e=document.createElement("h1"),t=document.createTextNode("MineSweeper");e.appendChild(t);let n=document.createElement("span");n.className=u.question,n.innerHTML="&#65046;",n.addEventListener("click",w),e.appendChild(n),this.parentElement.appendChild(e)}messageBox(){let e=document.createElement("div");e.className=u.messageBox,e.setAttribute("id","messageBox"),this.parentElement.appendChild(e)}board(){let e;const t=document.createElement("div");t.className=u.board;let n=this.parentElement.appendChild(t);for(let i=0;i<r.boardSize;i++)for(let o=0;o<r.boardSize;o++)e=document.createElement("div"),e.setAttribute("id",r.cellPrefix+i+""+o),n.appendChild(e)}instructions(){let e=document.createElement("div");e.className=u.instructions,e.setAttribute("id","instructions"),e.appendChild(document.createTextNode("Left Click: Open Cell")),e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode("Right Click: Place Flag")),e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode("Ctrl + Left Click: Open Adjacent, Non-Flagged Cells")),e.appendChild(document.createElement("br")),this.parentElement.appendChild(e)}controls(){const e=document.createElement("div");e.className=u.controls;const t=document.createElement("div");t.className=u.userDisplay,t.appendChild(document.createTextNode("Time")),t.appendChild(document.createElement("br"));const n=document.createElement("span");n.setAttribute("id","time"),n.appendChild(document.createTextNode("0")),t.appendChild(n),t.appendChild(document.createTextNode("s")),e.appendChild(t);const i=document.createElement("button");i.className=u.button,i.setAttribute("id","new-game-button"),i.appendChild(document.createTextNode("New Game")),e.appendChild(i);const o=document.createElement("div");o.className=u.userDisplay,o.appendChild(document.createTextNode("Remaining")),o.appendChild(document.createElement("br"));const a=document.createElement("span");a.setAttribute("id","mines-remaining"),a.appendChild(document.createTextNode("0")),o.appendChild(a),e.appendChild(o),this.parentElement.appendChild(e)}}const v=()=>{const s=new r;b.buildInterface(s),document.addEventListener("keydown",M),document.addEventListener("keyup",k),s.newGame()};window.Minesweeper=v;
